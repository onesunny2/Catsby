** 노션 기반 작성을 복사해 가져와서 링크도 첨부합니다.
https://www.notion.so/Catsby-1900c1bbc2a6806e9c64ddc3f0723d99?pvs=4




### 🍎 앱 이름(Catysby: 캣츠비)

### 🍎 앱 소개

<aside>

캣츠비에서는 개봉한 영화는 물론 개봉 예정 영화에 대한 간단한 정보들(제목, 장르, 배우 및 배역, 포스터)을 확인할 수 있습니다. 관심있는 영화는 따로 좋아요를 눌러 스크랩 해 모아볼 수 있어 따로 기록해 둘 필요가 없는 편리한 나만의 영화 백과사전 입니다.

</aside>

---

### 📱 앱 기능

![Simulator Screen Recording - iPhone 16 Pro Max - 2025-02-04 at 19.37.39.gif](attachment:c2bbca49-0b34-4530-8bab-cb0c896fc1bf:Simulator_Screen_Recording_-_iPhone_16_Pro_Max_-_2025-02-04_at_19.37.39.gif)

![Simulator Screen Recording - iPhone 16 Pro Max - 2025-02-04 at 19.47.35.gif](attachment:e5e60fe8-3d1e-4ebb-bcc6-6ea2168e851c:Simulator_Screen_Recording_-_iPhone_16_Pro_Max_-_2025-02-04_at_19.47.35.gif)

<aside>

✔️ 앱 첫 시작 시, 프로필을 설정합니다.

- 이미지 미선택 시, 처음 배정된 랜덤 이미지로 결정

- 조건에 맞는 닉네임 작성 시, 프로필 설정 완료 가능

</aside>

![Simulator Screen Recording - iPhone 16 Pro Max - 2025-02-04 at 20.04.38.gif](attachment:26282236-6566-470f-983d-152e4525f39a:Simulator_Screen_Recording_-_iPhone_16_Pro_Max_-_2025-02-04_at_20.04.38.gif)

<aside>

✔️ 우상단 검색버튼을 눌러 영화를 검색할 수 있습니다.

- 검색한 키워드가 포함된 영화는 20개씩 로딩되며, 전체 검색결과가 끝날 때 까지 무한스크롤 가능

- 영화 클릭 시 상세 화면 확인 가능

- 희망하는 영화에 좋아요 클릭 시, 앱 내 모든 화면에서 좋아요 여부 동기화

</aside>

![Simulator Screen Recording - iPhone 16 Pro Max - 2025-02-04 at 20.14.24.gif](attachment:0a44e90e-c2cc-4346-80b0-3bb77e5c3163:Simulator_Screen_Recording_-_iPhone_16_Pro_Max_-_2025-02-04_at_20.14.24.gif)

<aside>

✔️ 메인 화면에서는 < 오늘의 영화 TOP 20 >을 확인할 수 있습니다.

- 마음에 드는 영화의 좋아요 버튼을 누르면 상단 프로필 영역의 무비박스 갯수에 즉시 반영

- 조회를 희망하는 영화를 클릭 시, 상세 정보를 확인 가능 (줄거리, 캐스팅 정보, 포스터)

✔️ 메인 화면 상단에서 프로필 확인 및 편집을 할 수 있습니다.

- 현재 프로필 이미지/닉네임/가입날짜 그리고 보관 중인 영화 확인 가능

- 편집은 첫 프로필 설정 때와 동일

</aside>

![Simulator Screen Recording - iPhone 16 Pro Max - 2025-02-04 at 20.06.04.gif](attachment:1c4d1f78-be20-48b6-90e7-fcde0d073648:Simulator_Screen_Recording_-_iPhone_16_Pro_Max_-_2025-02-04_at_20.06.04.gif)

<aside>

✔️ 검색했던 키워드는 메인 화면에서 확인 가능하며 삭제가 가능합니다.

- 개별 키워드 삭제 or 전체 키워드 삭제 모두 가능

✔️ 검색 키워드의 X 표시가 아닌 부분을 클릭하면 해당 키워드가 포함된 검색결과를 불러올 수 있습니다.

</aside>

<aside>

✔️ 설정 탭 화면에서는 프로필 편집과 탈퇴가 가능합니다.

- 프로필 편집은 이전 플로우와 동일

- 탈퇴 시, 모든 프로필 설정 정보와 좋아요를 표시한 영화 정보 초기화

- 탈퇴 후 맨 처음 화면인 온보딩 화면으로 이동

</aside>

---

### 📚 앱 기술 스택

<aside>

**** Swift, UIKit, AlamoFire, SnapKit, Kingfisher, UserDefaults, GCD**

(어디까지가 기술스택인지 모르겠어효….🤷‍♀️)

</aside>

---

### 📄 앱 기술 설명

<aside>

**1. AlamoFire을 활용한 네트워크 매니저로 API 호출 담당**

- 네트워크 매니저는 외부에서 호출 시 같은 메모리에 접근해 하나의 인스턴스로 사용될 수 있도록 `싱글톤` 패턴을 사용

- APIKey는 `configuration settings file`에 작성해 .gitignore에 추가해 노출되지 않도록 하며, 키 값은 `Bundle의 extension`을 통해 호출해 사용

- 필요한 API는 네트워크 매니저 내 extension에서 `열거형`으로 케이스 나누었으며, 열거형 내부에서 [ HTTPHeaders / HTTPMethod / baseURL / endPoint / Parameters ]를 Alamofire의 형식에 맞게 `계산속성으로 분리`하여 관리

- API호출 메서드는 `모든 DTO가 하나의 메서드로 호출` 할 수 있도록 `Generic 타입`을 사용했으며, @escaping 매개변수로 request의 success와 fail에 대해 대응 가능하도록 함

</aside>

<aside>

**2. UserDefaultsManager로 앱 전반적인 저장 로직 관리**

- 네트워크 매니저와 마찬가지로 외부에서 하나의 인스턴스로 사용될 수 있도록 `싱글톤` 패턴을 사용

- 데이터 `저장 / 호출 / 초기화` 메서드를 총괄하고 있음

- 저장이 필요한 [ 프로필 이름 / 이미지 / 가입 날짜 / 첫 프로필 설정 유무 / 좋아요 유무 / 검색 키워드 ]를 열거형으로 나누어 `열거형의 타입 호출로 간단하게 메서드를 호출`해 사용할 수 있도록 함

- Date 타입의 경우 extension으로 호출 함수를 구현해 타입캐스팅의 단계를 추가로 거치지 않도록 함

</aside>

<aside>

**3. DispatchGroup의 적재적소 활용** (…제목이 마땅히 생각이…🧐)

- API 호출 결과 유무에 따라 화면 View 구성이 필요할 때 DispatchGroup의 `enter(), leave()`를 활용해 호출이 전부 완료된 후 작동될 수 있도록 제어

- 하나의 View에 여러 API 호출이 발생했을 때, 사용자 입장을 고려하여 모든 API 호출이 끝났을 때 데이터를 reload 시키고 contentOffset을 설정

- 모든 DispatchGroup은 네트워크 통신이 성공했을 때 뿐 아니라, 실패했을 때를 고려해 실패의 상황에서도 leave()될 수 있도록 구현

</aside>

<aside>

**4. Kingfisher를 활용한 Image Cashing & DownSampling**

- 메모리의 낭비가 최소화 되도록 UIImageView의 사이즈에 맞게 처리되도록 `다운샘플링` 설정

: 한 화면에 호출되는 이미지의 갯수가 많아 리사이징 보다는 메모리의 사용량 절약범위가 큰 다운샘플링 선택

- 앱의 반응성을 고려해 다운샘플링을 진행하면서 한번 이미지가 API에서 호출받으면 여러 번 호출하더라도 `캐시된 이미지를 사용`할 수 있도록 옵션 설정

</aside>

---

### 💡 트러블 슈팅

(** 트러블 슈팅이 될 만한게 있는지 .. 모르겠어요… 아래에 적은 것도 해당되는건지…)

<aside>

**1. enum의 타입 프로퍼티를 활용한 데이터 저장 로직의 한계점**

[문제 상황]

- 프로필 이미지명을 저장할 때 열거형 내부에 있는 String 타입의 타입프로퍼티를 사용하고 있었음. 해당 프로퍼티는 이미지 선택 화면에서 최종적으로 선택한 이미지를 담아서 UserDefaults에 저장할 때 프로퍼티 value로 저장하는 로직으로 사용. 

- 하지만 프로필 편집은 modal 화면에서 진행되는데, 이미지를 선택만 하고 저장하지 않고 창을 내려서 종료되는 경우, 다시 프로필 편집 화면을 열었을 때 설정되어 있는 프로필 이미지가 아닌 마지막에 선택하고 저장하지 않은 이미지가 기본으로 선택되어 있는 예외 상황이 발생

[해결 방법]

- 처음에는 앱 화면 생명주기를 통해 viewDidDisappear에서 타입 프로퍼티의 값을 무조건적으로 UserDefaults에 저장된 이미지로 변경해주었는데 이렇게 하면 선택한 이미지를 이전 화면에 전달해줘야 하는데, 타입 프로퍼티를  공동의 저장 프로퍼티로 사용하고 있다보니 선택한 이미지가 아닌 현재 설정된 이미지가 전달되는 문제가 발생

- 하나의 타입 프로퍼티로 현재 선택 중인 이미지와 저장하려는 이미지 2가지를 제어하려고 하다보니, 혼선이 생겨 꼬이는 부분이 발생하는 것 같아 타입 프로퍼티를 활용한 방법을 과감하게 포기함

- 이미지 선택 화면에서 고른 값을 클로저를 활용해 값 역전달을 시켰고, 값 역전달로 받은 이미지를 변수로 받아, 저장버튼을 눌렀을 때 UserDefaults의 value 값으로 저장시키게 됨

</aside>

### 🤔 트러블 슈팅은 아닌 그 무언가

<aside>

**1. 모든 화면에서의 영화 좋아요 유무 동기화 방법**

[문제 상황]

- 각 영화별 좋아요의 유무는 영화의 고유 ID가 Int 타입으로 존재해 [Int: Bool] 형태로 저장하고 값을 조회하는 형태로 딕셔너리로 관리 중. 현재 존재하는 화면들 중 메인화면 / 검색 결과 화면 / 영화 상세화면에서 좋아요 버튼을 누를 수 있어서 이전 화면으로 돌아가거나 다음 화면으로 넘어갈 때 동기화의 유무가 굉장히 중요한 요소

- 처음에는 연동이 필요한 모든 화면의 viewDidLoad에서 UserDefaults 내부의 저장된 값을 조회해 화면에 보여주고 있었고 이 때는 별도의 문제 사항은 없었음

-  하지만 이러한 방식은 매번 화면이 나타날 때마다 저장된 값을 호출해야하는 리소스 비용이 든다고 생각했고, 메인 화면의 20개의 오늘의 영화에도 반영될 가능성을 고려해야 했기에 비효율적인 방법이라고 판단

[해결 방법]

- 화면 전환으로 연결되는 구간은 클로저 구문을 활용한 역 값전달의 방법을 사용해 좋아요의 값 변동을 적용하는 방식으로 최대한 간결하게 데이터는 주고받을 수 있도록 구현

- 2단계의 화면전환을 거쳐서 메인화면에 반영되어야하는 경우는 collectionView의 indexPath.item을 찾는 과정이 더 번거로운 것 같아 클로져 구문 내부에서 reloadData()를 통해 변경된 내용 반영

</aside>
